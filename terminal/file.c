#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <lo/lo.h>
const char* glyph[] = {
    "\u00a4", "\u263a", "\u00a6", "\u00a8", "\u25c6", "\u00a9", "\u00ae",
    "\u2022", "\u00af", "\u26aa", "\u00b3", "\u00b4", "\u00b8", "\u00b9",
    "\u00be", "\u00c0", "\u00c1", "\u00c2", "\u2195", "\u00c3", "\u00b6",
    "\u00a7", "\u00c8", "\u00ca", "\u2191", "\u2193", "\u2192", "\u2190",
    "\u00cb", "\u2194", "\u25b2", "\u25bc", "\u2212", "\u00cc", "\u00c7",
    "\u00fc", "\u00e9", "\u00e2", "\u00e4", "\u00e0", "\u00e5", "\u00e7",
    "\u00ea", "\u00eb", "\u00e8", "\u00ef", "\u00ee", "\u00ec", "\u00c4",
    "\u00c5", "\u00c9", "\u00e6", "\u00c6", "\u00f4", "\u00f6", "\u00f2",
    "\u00fb", "\u00f9", "\u00ff", "\u00d6", "\u00dc", "\u00a2", "\u00a3",
    "\u00a5", "\u00cd", "\u00ce", "\u00e1", "\u00ed", "\u00f3", "\u00fa",
    "\u00f1", "\u00d1", "\u00aa", "\u00ba", "\u00bf", "\u00cf", "\u00ac",
    "\u00bd", "\u00bc", "\u00a1", "\u00ab", "\u00bb", "\u2591", "\u2592",
    "\u2593", "\u2502", "\u2524", "\u2561", "\u2562", "\u2556", "\u2555",
    "\u2563", "\u2551", "\u2557", "\u255d", "\u255c", "\u255b", "\u2510",
    "\u2514", "\u2534", "\u252c", "\u251c", "\u2500", "\u253c", "\u255e",
    "\u255f", "\u255a", "\u2554", "\u2569", "\u2566", "\u2560", "\u2550",
    "\u256c", "\u2567", "\u2568", "\u2564", "\u2565", "\u2559", "\u2558",
    "\u2552", "\u2553", "\u256b", "\u256a", "\u2518", "\u250c", "\u00d0",
    "\u2584", "\u258c", "\u2590", "\u2580", "\u03b1", "\u00df", "\u00d2",
    "\u03c0", "\u00d3", "\u00d4", "\u00b5", "\u00d5", "\u00d7", "\u00d8",
    "\u00d9", "\u00da", "\u221e", "\u00db", "\u00dd", "\u2229", "\u2261",
    "\u00b1", "\u2a7e", "\u2a7d", "\u00de", "\u00e3", "\u00f7", "\u2248",
    "\u00b0", "\u00f0", "\u00b7", "\u221a", "\u207f", "\u00b2", "\u25a0",
    "\u00a0", "\u00f5", "\u00f8", "\u00fd", "\u00fe", "\u2501", "\u2503",
    "\u2504", "\u2505", "\u2506", "\u2507", "\u2508", "\u2509", "\u250a",
    "\u250b", "\u250d", "\u250e", "\u250f", "\u2511", "\u2512", "\u2513",
    "\u2515", "\u2516", "\u2517", "\u2519", "\u251a", "\u251b", "\u251d",
    "\u251e", "\u251f", "\u2520", "\u2521", "\u2522", "\u2523", "\u2525",
    "\u2526", "\u2527", "\u2528", "\u2529", "\u252a", "\u252b", "\u252d",
    "\u252e", "\u252f", "\u2530", "\u2531", "\u2532", "\u2533", "\u2535",
    "\u2536", "\u2537", "\u2538", "\u2539", "\u253a", "\u253b", "\u253d",
    "\u253e", "\u253f", "\u2540", "\u2541", "\u2542", "\u2543", "\u2544",
    "\u2545", "\u2546", "\u2547", "\u2548", "\u2549", "\u254a", "\u254b",
    "\u254c", "\u254d", "\u254e", "\u254f", "\u256d", "\u256e", "\u256f",
    "\u2570", "\u2571", "\u2572", "\u2573", "\u2574", "\u2575", "\u2576",
    "\u2577", "\u2578", "\u2579", "\u257a", "\u257b", "\u257c", "\u257d",
    "\u257e", "\u257f", "\u2581", "\u2582", "\u2583", "\u2585", "\u2586",
    "\u2587", "\u2589", "\u258a", "\u258b", "\u258d", "\u258e", "\u258f",
    "\u2594", "\u2595", "\u2596", "\u2597", "\u2598", "\u2599", "\u259a",
    "\u259b", "\u259c", "\u259d", "\u259e", "\u259f", "\u03bb", "\u03c7",
    "\u03bc", "\u0461", "\u2070", "\u2074", "\u2075", "\u2076", "\u2077",
    "\u2078", "\u2079", "\u2080", "\u2081", "\u2082", "\u2083", "\u2084",
    "\u2085", "\u2086", "\u2087", "\u2088", "\u2089", "\u21c4", "\u21e8",
    "\u2206", "\u2207", "\u2208", "\u2218", "\u2223", "\u2228", "\u222a",
    "\u2235", "\u223c", "\u2260", "\u226c", "\u2282", "\u2283", "\u2296",
    "\u22a2", "\u22a3", "\u22a4", "\u22a5", "\u22c6", "\u2308", "\u230a",
    "\u2336", "\u2337", "\u2338", "\u2339", "\u233a", "\u233b", "\u233c",
    "\u233d", "\u233e", "\u233f", "\u2340", "\u2341", "\u2342", "\u2343",
    "\u2344", "\u2345", "\u2346", "\u2347", "\u2348", "\u2349", "\u234a",
    "\u234b", "\u234c", "\u234d", "\u234e", "\u234f", "\u2350", "\u2351",
    "\u2352", "\u2353", "\u2354", "\u2355", "\u2356", "\u2357", "\u2358",
    "\u2359", "\u235a", "\u235b", "\u235c", "\u235d", "\u235e", "\u235f",
    "\u2360", "\u2361", "\u2362", "\u2363", "\u2364", "\u2365", "\u2366",
    "\u2367", "\u2368", "\u2369", "\u236a", "\u236b", "\u236c", "\u236d",
    "\u236e", "\u236f", "\u2370", "\u2371", "\u2372", "\u2373", "\u2374",
    "\u03c9", "\u2376", "\u2377", "\u2378", "\u2379", "\u2227", "\u22bc",
    "\u22bd", "\u2b26", "\u2395", "\u25e6", "\u0152", "\u0153", "\u0178",
    "\u2200", "\u2205", "\u2262", "\u2286", "\u2287", "\u2299", "\u2018",
    "\u2019", "\u201a", "\u201c", "\u201d", "\u201e", "\u2020", "\u2021",
    "\u2026", "\u20ac", "\u25b6", "\u25c0", "\ufffd"};

int state = 0;
float rndf() {
  state += 12345;
  state *= 1103515245;  // overflow
  return state / 4294967296.0;
}
unsigned rndu() {
  state += 12345;
  state *= 1103515245;  // overflow
  return state;
}


const int length = sizeof(glyph) / sizeof(glyph[0]);

int main() {
  //for (int k = 0; k < length; ++k) {
  //  printf("%d: %zu\n", k, strnlen(glyph[k], 10));
  //}

  srand(0);

  lo_address t = lo_address_new("224.0.7.23", "7770");
  while (1) {
    usleep(25000);
    int x = 25 + 25 * rndf();
    int y = 16 * 15 * rndf();
    int i = rndu() % length;
    //int x = rndu() % 53; // 25 + 25 * rndf();
    //int y = rndu() % 32; // 16 * 15 * rndf();
    //int i = rndu() % length;
    //int x = rand() % 53;
    //int y = rand() % 32;
    //int i = rand() % length;
    printf("%d: %s\n", i, glyph[i]);
    if (lo_send(t, "/print", "iis", x, y, glyph[i]) == -1) {
      printf("OSC error %d: %s\n", lo_address_errno(t), lo_address_errstr(t));
    }
  }
}
